{"version":3,"sources":["webpack:///./src/common/js/dom.js","webpack:///src/base/slider/slider.vue","webpack:///./src/base/slider/slider.vue?afc4","webpack:///./src/base/slider/slider.vue","webpack:///./src/common/js/recommend.js","webpack:///src/components/recommend/recommend.vue","webpack:///./src/components/recommend/recommend.vue?d79d","webpack:///./src/components/recommend/recommend.vue","webpack:///./src/api/recommend.js"],"names":["el","className","RegExp","test","hasClass","newClass","split","push","join","__webpack_exports__","name","value","setAttribute","getAttribute","slider","Boolean","Number","_this","this","_setSliderWidth","_initdots","_initSlider","_autoPlay","refresh","children","clientWidth","i","sliderWidth","length","_this2","loop","pageX","pageIndex","timer","_this3","interval","slider_slider","render","_vm","_h","$createElement","_c","_self","ref","staticClass","_t","_v","_l","item","index","key","class","active","currentPageIndex","_s","staticRenderFns","base_slider_slider","__webpack_require__","normalizeComponent","ssrContext","Recommend","_ref","id","desc","avatar","num","classCallCheck_default","recommend_recommend","mixin","_getRecommendSwiperData","_getDiscList","methods","extends_default","bottom","Object","recommend","ein","list","data","dissid","dissname","imgurl","listennum","result","Slider","Scroll","scroll_scroll","Loading","loading","components_recommend_recommend","attrs","discList","pulldown","pullup","on","pulldownMore","scrollToEnd","loadMore","recommendSwiperData","href","linkUrl","src","picUrl","alt","load","loadImg","_e","click","$event","selectItem","directives","rawName","expression","width","height","domProps","innerHTML","toFixed","title","recommend_Component","recommend_normalizeComponent","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_assign___default","__WEBPACK_IMPORTED_MODULE_3__config__","platform","uin","needNewCode","__WEBPACK_IMPORTED_MODULE_2_common_js_jsonp__","sin","picmid","rnd","Math","random","g_tk","loginUin","hostUin","format","categoryId","sortId","__WEBPACK_IMPORTED_MODULE_4_axios___default","a","get","params","then","res","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default","resolve","type","json","utf8","onlysong","disstid"],"mappings":"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","file":"static/js/1.4944bdbe3dfd0bca8eb3.js","sourcesContent":["// 为目标DOM添加class\r\nexport function addClass(el, className) {\r\n    if (hasClass(el, className)) {\r\n        return\r\n    }\r\n    let newClass = el.className.split(' ')\r\n    newClass.push(className)\r\n    el.className = newClass.join(' ')\r\n}\r\n\r\n// 检查当前目标DOM是否有该class\r\nfunction hasClass(el, className) {\r\n    let reg = new RegExp('(^|\\\\s)' + className + '(\\\\s|$)')\r\n    return reg.test(el.className)\r\n}\r\n\r\nexport function getAttributeData(el, name, value) {\r\n    const prefix = 'data-'\r\n    name = prefix + name\r\n    if (value) {\r\n        return el.setAttribute(name, value)\r\n    } else {\r\n        return el.getAttribute(name)\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/common/js/dom.js","<!-- slider轮播图组件 -->\r\n<template>\r\n    <div class=\"slider\" ref=\"sliderWrapper\">\r\n        <div class=\"slider-items\" ref=\"sliderItems\">\r\n            <slot></slot>\r\n        </div>\r\n        <div class=\"dots\">\r\n            <span \r\n                class=\"dot\" \r\n                :class=\"{active: currentPageIndex === index}\" \r\n                v-for=\"(item, index) in dots\" \r\n                :key=\"index\">\r\n                {{item}}\r\n            </span>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script type='text/ecmascript-6'>\r\n    import {addClass} from 'common/js/dom'\r\n    import BScroll from 'better-scroll'\r\n    export default {\r\n        name: 'slider',\r\n        props: {\r\n            loop: {\r\n                type: Boolean,\r\n                default: true\r\n            },\r\n            autoPlay: {\r\n                type: Boolean,\r\n                default: true\r\n            },\r\n            interval: {\r\n                type: Number,\r\n                default: 3000\r\n            }\r\n        },\r\n        data () {\r\n            return {\r\n                dots: [],\r\n                currentPageIndex: 0\r\n            }\r\n        },\r\n        mounted () {\r\n            setTimeout(() => {\r\n                this._setSliderWidth()\r\n                this._initdots()\r\n                this._initSlider()\r\n                if (this.autoPlay) {\r\n                    this._autoPlay()\r\n                }\r\n            }, 20)\r\n\r\n            window.addEventListener('resize', () => {\r\n                if (!this.slider) {\r\n                    return\r\n                }\r\n                this._setSliderWidth(true)\r\n                this.slider.refresh()\r\n            })\r\n        },\r\n        methods: {\r\n            // DOM元素挂载完成之后，计算slider组件的宽度\r\n            _setSliderWidth (isResize) {\r\n                // 获取轮播组件内的所有子元素\r\n                this.children = this.$refs.sliderItems.children\r\n                let width = 0\r\n                let sliderWidth = this.$refs.sliderWrapper.clientWidth\r\n                for (let i = 0; i < this.children.length; i++) {\r\n                    let child = this.children[i]\r\n                    addClass(child, 'slider-item')\r\n                    child.style.width = sliderWidth + 'px'\r\n                    width += sliderWidth\r\n                }\r\n                if (this.loop && !isResize) {\r\n                    width += 2 * sliderWidth\r\n                }\r\n                this.$refs.sliderItems.style.width = width + 'px'\r\n            },\r\n            _initdots () {\r\n                this.dots = new Array(this.children.length)\r\n            },\r\n            _initSlider () {\r\n                this.slider = new BScroll(this.$refs.sliderWrapper, {\r\n                    scrollX: true,\r\n                    scrollY: false,\r\n                    momentum: false,\r\n                    snap: true,\r\n                    snapLoop: this.loop,\r\n                    snapThreshold: 0.3,\r\n                    snapSpeed: 400\r\n                })\r\n                this.slider.on('scrollEnd', () => {\r\n                    let pageIndex = this.slider.getCurrentPage().pageX\r\n                    if (this.loop) {\r\n                        pageIndex -= 1\r\n                    }\r\n                    this.currentPageIndex = pageIndex\r\n                    if (this.autoPlay) {\r\n                        this._autoPlay()\r\n                    }\r\n                })\r\n                this.slider.on('beforeScrollStart', () => {\r\n                    if (this.autoPlay) {\r\n                        clearTimeout(this.timer)\r\n                    }\r\n                })\r\n            },\r\n            _autoPlay () {\r\n                let pageIndex = this.currentPageIndex + 1\r\n                if (this.loop) {\r\n                    pageIndex += 1\r\n                }\r\n                this.timer = setTimeout(() => {\r\n                    this.slider.goToPage(pageIndex, 0, 400)\r\n                }, this.interval)\r\n            }\r\n        },\r\n        destroyed () {\r\n            clearTimeout(this.timer)\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n    .slider {\r\n        min-height: 12.8rem;\r\n        .slider-items {\r\n            position: relative;\r\n            overflow: hidden;\r\n            white-space: nowrap;\r\n            .slider-item {\r\n                float: left;\r\n                box-sizing: border-box;\r\n                overflow: hidden;\r\n                text-align: center;\r\n                a {\r\n                    display: block;\r\n                    width: 100%;\r\n                    overflow: hidden;\r\n                    text-decoration: none;\r\n                    img {\r\n                        width: 100%;\r\n                        display: block;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        .dots {\r\n            position: absolute;\r\n            bottom: 1.2rem;\r\n            left: 50%;\r\n            transform: translate(-50%, 0);\r\n            .dot {\r\n                display: inline-block;\r\n                margin: 0 .4rem;\r\n                width: .8rem;\r\n                height: .8rem;\r\n                border-radius: 50%;\r\n                background: #e84639;\r\n                &.active {\r\n                    width: 12px;\r\n                    border-radius: 5px;\r\n                    background: #000;\r\n                }\r\n            }\r\n        }\r\n    }\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/base/slider/slider.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"sliderWrapper\",staticClass:\"slider\"},[_c('div',{ref:\"sliderItems\",staticClass:\"slider-items\"},[_vm._t(\"default\")],2),_vm._v(\" \"),_c('div',{staticClass:\"dots\"},_vm._l((_vm.dots),function(item,index){return _c('span',{key:index,staticClass:\"dot\",class:{active: _vm.currentPageIndex === index}},[_vm._v(\"\\n            \"+_vm._s(item)+\"\\n        \")])}))])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5d76b8b8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/base/slider/slider.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-5d76b8b8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./slider.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./slider.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./slider.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5d76b8b8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./slider.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-5d76b8b8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/slider/slider.vue\n// module id = null\n// module chunks = ","export default class Recommend {\r\n    constructor({id, name, desc, avatar, num}) {\r\n        this.id = id\r\n        this.name = name\r\n        this.desc = desc\r\n        this.avatar = avatar\r\n        this.num = num\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/common/js/recommend.js","<!-- 推荐页面组件 -->\r\n<template>\r\n    <div class=\"recommend-wrapper\" ref=\"recommend\">\r\n        <!-- 轮播图 -->\r\n        <!-- pulldown是否派发下拉事件，pullup是否派发上拉事件 -->\r\n        <Scroll \r\n            class=\"scroll-slot\" \r\n            :data=\"discList\" \r\n            @pulldown=\"pulldownMore\" \r\n            :pulldown=\"pulldown\" \r\n            :pullup=\"pullup\" \r\n            ref=\"scroll\" \r\n            @scrollToEnd=\"loadMore\">\r\n            <div>\r\n                <div class=\"slider-wrapper\" v-if=\"recommendSwiperData.length\">\r\n                    <slider>\r\n                        <!-- 以下代码片段会被插入到slider组件中的slot插槽中 -->\r\n                        <div v-for=\"item in recommendSwiperData\" :key=\"item.id\">\r\n                            <a :href=\"item.linkUrl\">\r\n                                <img class=\"needsclick\"  @load=\"loadImg\" :src=\"item.picUrl\" alt=\"\">\r\n                            </a>\r\n                        </div>\r\n                    </slider>\r\n                </div>\r\n                <!-- 歌单 -->\r\n                <div class=\"recommend-list\">\r\n                    <h2 class=\"title\">热门歌单推荐</h2>\r\n                    <ul class=\"list-wrap\">\r\n                        <li class=\"list-item\" v-for=\"(item, index) in discList\" :key=\"index\" @click=\"selectItem(item)\">\r\n                            <div class=\"img-wrapper\">\r\n                                <img width=\"60\" height=\"60\" v-lazy=\"item.avatar\" alt=\"\">\r\n                            </div>\r\n                            <div class=\"text-info\">\r\n                                <h2 class=\"disc-name\">{{item.name}}</h2>\r\n                                <p class=\"disc-desc padding-top-bom\" v-html=\"item.desc\"></p>\r\n                                <p class=\"disc-desc\">播放{{(item.num / 10000).toFixed(2)}}万</p>\r\n                            </div>\r\n                        </li>\r\n                        <loading v-show=\"hasMore\" class=\"load-more\" title=\"努力加载中...\"></loading>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            <div class=\"loading-containers\" v-if=\"!discList.length && !recommendSwiperData.length\">\r\n                <loading></loading>\r\n            </div>\r\n        </Scroll>\r\n        <router-view></router-view>\r\n    </div>\r\n</template>\r\n\r\n<script type='text/ecmascript-6'>\r\n    import {getRecommendSwiperData, getDiscList} from 'api/recommend'\r\n    import {ERR_OK} from 'api/config'\r\n    import Slider from 'base/slider/slider'\r\n    import Scroll from 'base/scroll/scroll'\r\n    import Loading from 'base/loading/loading'\r\n    import {playListMixin} from 'common/js/mixin'\r\n    import Recommend from 'common/js/recommend'\r\n    import {mapMutations} from 'vuex'\r\n    \r\n    export default {\r\n        mixins: [playListMixin],\r\n        data () {\r\n            return {\r\n                recommendSwiperData: [],\r\n                discList: [],\r\n                pullup: true,\r\n                pulldown: true,\r\n                // sin 和 ein 是从qq音乐接口分析而来，用来维护加载分页请求时的变量\r\n                sin: 0,\r\n                ein: 29,\r\n                // hasMOore，设置一是否能加载更多的标志位，为true时可以加载更多，否则不可以\r\n                hasMore: true\r\n            }\r\n        },\r\n        created () {\r\n            this._getRecommendSwiperData()\r\n            this._getDiscList()\r\n        },\r\n        methods: {\r\n            handlePlayList (playList) {\r\n                const bottom = playList.length > 0 ? '60px' : ''\r\n                this.$refs.recommend.style.bottom = bottom\r\n                this.$refs.scroll.refresh()\r\n            },\r\n            _getRecommendSwiperData () {\r\n                const result = getRecommendSwiperData()\r\n                result.then((res) => {\r\n                    if (res.code === ERR_OK) {\r\n                        this.recommendSwiperData = res.data.slider\r\n                    }\r\n                })\r\n            },\r\n            _getDiscList () {\r\n                this.hasMore = true\r\n                const result = getDiscList(this.sin, this.ein)\r\n                result.then((res) => {\r\n                    if (res.code === ERR_OK) {\r\n                        this.discList = this._normalLizeList(res.data.list)\r\n                        this._checkHasMore(res.data)\r\n                    }\r\n                })\r\n            },\r\n            _normalLizeList (list) {\r\n                let result = []\r\n                list.forEach((item) => {\r\n                    result.push(new Recommend({\r\n                        id: item.dissid,\r\n                        name: item.dissname,\r\n                        avatar: item.imgurl,\r\n                        desc: item.creator.name,\r\n                        num: item.listennum\r\n                    }))\r\n                })\r\n                return result\r\n            },\r\n            // 完善上拉加载更多,即分页请求\r\n            loadMore () {\r\n                if (!this.hasMore) {\r\n                    return\r\n                }\r\n                this.sin += 30\r\n                this.ein += 30\r\n                const result = getDiscList(this.sin, this.ein)\r\n                result.then((res) => {\r\n                    if (res.code === ERR_OK) {\r\n                        console.log(res.data)\r\n                        this.discList = this.discList.concat(this._normalLizeList(res.data.list))\r\n                        this._checkHasMore(res.data)\r\n                    }\r\n                })\r\n            },\r\n            // 根据返回数据结构及特征，判断满足什么条件时，把hasMore置为false\r\n            _checkHasMore (list) {\r\n                if (this.ein > list.sum) {\r\n                    this.hasMore = false\r\n                }\r\n            },\r\n            pulldownMore () {\r\n                console.log('触发下拉加载更多')\r\n            },\r\n            selectItem (item) {\r\n                console.log(item)\r\n                this.$router.push({\r\n                    path: `/recommend/${item.id}`\r\n                })\r\n                this.setDisc(item)\r\n            },\r\n            loadImg () {\r\n                if (!this.checkedLoaded) {\r\n                    this.checkedLoaded = true\r\n                    this.$refs.scroll.refresh()\r\n                }\r\n            },\r\n            ...mapMutations({\r\n                setDisc: 'SET_DISC'\r\n            })\r\n        },\r\n        components: {\r\n            Slider,\r\n            Scroll,\r\n            Loading\r\n        }\r\n    }\r\n</script>\r\n\r\n<style lang='less' scoped>\r\n    .recommend-wrapper {\r\n        position: fixed;\r\n        width: 100%;\r\n        top: 9.2rem;\r\n        .scroll-slot {\r\n            background: #222;\r\n            // height: 100%;\r\n            height: 48rem;\r\n            overflow: hidden;\r\n            .slider-wrapper {\r\n                min-height: 12.8rem;\r\n                width: 100%;\r\n                position: relative;\r\n                overflow: hidden;\r\n            }\r\n            .recommend-list {\r\n                background: #222;\r\n                // margin-top: -.3rem;\r\n                .title {\r\n                    height: 4.4rem;\r\n                    line-height: 4.4rem;\r\n                    text-align: center;\r\n                    font-size: 1.4rem;\r\n                    color: #e84639;\r\n                }\r\n                .list-item {\r\n                    display: flex;\r\n                    padding: 0 2rem 2rem 2rem;\r\n                    align-items: center;\r\n                    .img-wrapper {\r\n                        padding-right: 1.6rem;\r\n                    }\r\n                    .text-info {\r\n                        width: 20rem;\r\n                        font-size: 1.2rem;\r\n                        .disc-name {\r\n                            color: #fff;\r\n                            font-weight: bold;\r\n                            overflow: hidden;\r\n                            text-overflow: ellipsis;\r\n                            white-space: nowrap;\r\n                        }\r\n                        .padding-top-bom {\r\n                            padding: .4rem 0;\r\n                        }\r\n                    }\r\n                }\r\n                .load-more {\r\n                    padding-bottom: 2rem;\r\n                }\r\n            }\r\n        }\r\n        .loading-containers{\r\n            position: absolute;\r\n            width: 100%;\r\n            top: 50%;\r\n            transform: translateY(-50%);\r\n        }\r\n    }\r\n</style>\n\n\n// WEBPACK FOOTER //\n// src/components/recommend/recommend.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"recommend\",staticClass:\"recommend-wrapper\"},[_c('Scroll',{ref:\"scroll\",staticClass:\"scroll-slot\",attrs:{\"data\":_vm.discList,\"pulldown\":_vm.pulldown,\"pullup\":_vm.pullup},on:{\"pulldown\":_vm.pulldownMore,\"scrollToEnd\":_vm.loadMore}},[_c('div',[(_vm.recommendSwiperData.length)?_c('div',{staticClass:\"slider-wrapper\"},[_c('slider',_vm._l((_vm.recommendSwiperData),function(item){return _c('div',{key:item.id},[_c('a',{attrs:{\"href\":item.linkUrl}},[_c('img',{staticClass:\"needsclick\",attrs:{\"src\":item.picUrl,\"alt\":\"\"},on:{\"load\":_vm.loadImg}})])])}))],1):_vm._e(),_vm._v(\" \"),_c('div',{staticClass:\"recommend-list\"},[_c('h2',{staticClass:\"title\"},[_vm._v(\"热门歌单推荐\")]),_vm._v(\" \"),_c('ul',{staticClass:\"list-wrap\"},[_vm._l((_vm.discList),function(item,index){return _c('li',{key:index,staticClass:\"list-item\",on:{\"click\":function($event){_vm.selectItem(item)}}},[_c('div',{staticClass:\"img-wrapper\"},[_c('img',{directives:[{name:\"lazy\",rawName:\"v-lazy\",value:(item.avatar),expression:\"item.avatar\"}],attrs:{\"width\":\"60\",\"height\":\"60\",\"alt\":\"\"}})]),_vm._v(\" \"),_c('div',{staticClass:\"text-info\"},[_c('h2',{staticClass:\"disc-name\"},[_vm._v(_vm._s(item.name))]),_vm._v(\" \"),_c('p',{staticClass:\"disc-desc padding-top-bom\",domProps:{\"innerHTML\":_vm._s(item.desc)}}),_vm._v(\" \"),_c('p',{staticClass:\"disc-desc\"},[_vm._v(\"播放\"+_vm._s((item.num / 10000).toFixed(2))+\"万\")])])])}),_vm._v(\" \"),_c('loading',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.hasMore),expression:\"hasMore\"}],staticClass:\"load-more\",attrs:{\"title\":\"努力加载中...\"}})],2)])]),_vm._v(\" \"),(!_vm.discList.length && !_vm.recommendSwiperData.length)?_c('div',{staticClass:\"loading-containers\"},[_c('loading')],1):_vm._e()]),_vm._v(\" \"),_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-706a930d\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/recommend/recommend.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-706a930d\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./recommend.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./recommend.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./recommend.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-706a930d\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./recommend.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-706a930d\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/recommend/recommend.vue\n// module id = null\n// module chunks = ","import jsonp from 'common/js/jsonp'\r\nimport {commonParams, options} from './config'\r\nimport axios from 'axios'\r\n\r\nexport function getRecommendSwiperData() {\r\n    const url = 'https://c.y.qq.com/musichall/fcgi-bin/fcg_yqqhomepagerecommend.fcg'\r\n    // es6 assign方法，可以把多个对象assign成一个对象\r\n    const data = Object.assign({}, commonParams, {\r\n        // 这些参数不是非必须的，可和后台一起定义\r\n        platform: 'h5',\r\n        uin: 0,\r\n        needNewCode: 1\r\n    })\r\n    return jsonp(url, data, options)\r\n}\r\n\r\n// 从qq音乐抓取首页推荐歌单，需要设置referer代理\r\nexport function getDiscList(sin, ein) {\r\n    const url = '/api/getDiscList'\r\n    const data = Object.assign({}, commonParams, {\r\n        picmid: 1,\r\n        rnd: Math.random(),\r\n        g_tk: 5381,\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        format: 'json',\r\n        platform: 'yqq',\r\n        needNewCode: 0,\r\n        categoryId: 136,\r\n        sortId: 5,\r\n        sin: sin,\r\n        ein: ein\r\n    })\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then((res) => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}\r\n\r\n// 抓取歌单对应歌曲内容\r\nexport function getDiscSongList(dissid) {\r\n    const url = '/api/getDiscSongList'\r\n    const data = Object.assign({}, commonParams, {\r\n        type: 1,\r\n        json: 1,\r\n        utf8: 1,\r\n        onlysong: 0,\r\n        disstid: dissid,\r\n        loginUin: 0,\r\n        hostUin: 0,\r\n        platform: 'yqq',\r\n        needNewCode: 0,\r\n        format: 'json'\r\n    })\r\n    return axios.get(url, {\r\n        params: data\r\n    }).then((res) => {\r\n        return Promise.resolve(res.data)\r\n    })\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/recommend.js"],"sourceRoot":""}